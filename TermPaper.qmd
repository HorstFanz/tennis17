---
title: "TermPaper"
author: "Group 3"
format: html
editor: visual
---

# Tennis Data Set

```{r, output=FALSE}
library(tidyverse)
```

## Describing the Data

### Structure of the Data Set

### Audience and Research Questions (optional)

### Key findings

One of the primary objectives in analyzing this dataset was to explore the question: *What makes a great tennis player?* To address this, we adopted two distinct perspectives. The first focused on match outcomes, aiming to identify which players had the highest number of match victories.

```{r}
# import dataset
tennis <- read.csv2("Dataset3_Tennis.csv")

# calculate total wins using dplyr
totalWins <- tennis %>% 
  select(tourney_slug, winner_name) %>%
  count(winner_name) %>% 
  rename(player = winner_name) %>% 
  arrange(desc(n))

# calculate total losses using dplyr
totalLosses <- tennis %>% 
  select(tourney_slug, loser_name) %>%
  count(loser_name) %>% 
  rename(player = loser_name) %>% 
  arrange(desc(n))
```

```{r, echo=TRUE}
# create subset using dplyr
winnerTable <- left_join(totalWins, totalLosses, by = "player") %>%
  mutate(win_loss_score = paste0(n.x, ":", n.y)) %>%
  mutate(win_loss_ratio = n.x/(n.x+n.y)) %>%
  arrange(desc(n.x)) %>% 
  head(n = 10)
```

This plot displays the top 10 tennis players with the most match wins. Each bar represents a player's total number of wins, with the bars ordered from most to least wins. The fill color of each bar reflects the player's win-loss ratio—darker blue indicates a higher winning rate. A label on each bar shows the win-loss record (e.g., 30:5). This visualization helps highlight not only who won the most matches but also how dominant they were in terms of win percentage.

```{r}
# plot data using ggplot
  ggplot(data = winnerTable, aes(x = n.x, y = reorder(player, n.x), fill = win_loss_ratio)) + 
    geom_bar(stat = "identity", alpha = 0.7) +
    geom_text(aes(label = win_loss_score),hjust = -0.2, vjust = 0.5,size = 4) +
    theme_minimal() + 
    labs(title = "Overall Matches Won of top 10 Players", x = "Total Wins", y = "") +
    theme(plot.title = element_text(face="bold", hjust = 0.5),
          legend.position = "right") +
    scale_x_continuous(limits = c(0, 35)) +
    scale_fill_gradient(name = "Winning Rate", low = "lightblue", high = "darkblue")
```

The second perspective was more analytical, involving a comparison of performance metrics between two groups—winners and losers. The goal was to determine which factors distinguish successful players from those who are less successful. To achieve this, we calculated and compared several key performance indicators, including ace rate, double fault rate, first serve percentage, first serve return points won, and total service points won. Each of these metrics was expressed as a percentage, allowing for a clear and effective visual comparison across the two groups.

Additional plots can be found at [this Website](https://hansjoerg.shinyapps.io/tennis_stats/#section-why-they-won).

## Statistical Analysis

### Correlation 

### Regression Model

### Hypothesis testing

## Additional Remarks

### What could have also been covered

### Limitations
